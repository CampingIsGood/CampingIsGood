<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìƒì„¸ í›„ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="review.css">
</head>
<body>
<div class="review-bg">
  <div class="review-hero">
    <div class="review-rating" id="hero-rating">4.3</div>
    <div class="review-camp">ë¶í•œì‚° ì™€ì¼ë“œ ìº í•‘ì¥</div>
    <div class="review-address">ì„œìš¸ì‹œ ì¢…ë¡œêµ¬ 13ê¸¸ 130-2</div>
  </div>
<div class="review-main">
    <div class="review-toolbar">
        <select id="filter-star">
            <option value="all">ë³„ì  ì „ì²´</option>
            <option value="5">â­ï¸ 5ì ë§Œ</option>
            <option value="4">â­ï¸ 4ì ë§Œ</option>
            <option value="3">â­ï¸ 3ì ë§Œ</option>
            <option value="2">â­ï¸ 2ì ë§Œ</option>
            <option value="1">â­ï¸ 1ì ë§Œ</option>
        </select>
        <select id="sort-order">
            <option value="latest">ìµœì‹ ìˆœ</option>
            <option value="oldest">ì˜¤ë˜ëœìˆœ</option>
            <option value="highstar">ë³„ì ë†’ì€ìˆœ</option>
            <option value="lowstar">ë³„ì ë‚®ì€ìˆœ</option>
        </select>
    </div>

    <div class="review-list-wrapper">
      <div class="review-list" id="review-list">
        <!-- í›„ê¸° ì•„ì´í…œë“¤ì´ JSì—ì„œ ë Œë”ë§ë¨ -->
      </div>
    </div>
    <form class="review-form" id="review-form" autocomplete="off">
      <div class="review-form-row">
        <div class="review-form-stars" id="form-stars">
          <!-- ë³„ 5ê°œ ìƒì„± -->
        </div>
        <label class="review-photo-label">
          ğŸ“· ì‚¬ì§„ì²¨ë¶€
          <input type="file" id="photo-upload" accept="image/*" disabled>
        </label>
      </div>
      <textarea placeholder="ì—¬ê¸°ì— í›„ê¸°ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”!" maxlength="300" required></textarea>
      <button type="submit">í›„ê¸° ë“±ë¡</button>
    </form>
  </div>
</div>
<script>
const initialReviews = [
  { star: 5, text: "ìº í•‘ì¥ ë„ˆë¬´ ì˜ˆì˜ê³  ì‹œì„¤ì´ ê¹¨ë—í•´ìš”! ì•„ì´ì™€ ë‹¤ì‹œ ì˜¤ê³  ì‹¶ì–´ìš”.", photo: false, date: "2024-06-12 10:11" },
  { star: 2, text: "ëƒ„ìƒˆê°€ ì¢€ ë‚¬ì–´ìš”.. í™”ì¥ì‹¤ ì²­ê²° ê°œì„  ë°”ëë‹ˆë‹¤.", photo: false, date: "2024-06-11 22:18" },
  { star: 4, text: "ì•„ì¹¨ì— ìƒˆì†Œë¦¬ ë“¤ìœ¼ë©´ì„œ ì‚°ì±…í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ì–´ìš”.", photo: false, date: "2024-06-11 20:55" },
  { star: 5, text: "ì—¬ê¸° ì§„ì§œ ì¶”ì²œë“œë¦½ë‹ˆë‹¤! ë‹¤ì‹œ ê°€ê³  ì‹¶ì–´ìš”.", photo: true, date: "2024-06-10 21:31" },
  { star: 3, text: "ë¬´ë‚œë¬´ë‚œ. ê°€ê²©ë§Œ ì¡°ê¸ˆ ë” ì‹¸ë©´ ì¢‹ì„ë“¯.", photo: false, date: "2024-06-09 19:20" },
  { star: 1, text: "ì—¬ê¸° ê³°ì´ ì§„ì§œ ë‚˜ì˜´. ë¬´ì„œì›Œìš”.", photo: false, date: "2024-06-09 18:07" },
  { star: 5, text: "ì¹œì ˆí•˜ê³  ë·°ë„ ìµœê³ ! ë¬¼ë†€ì´ë„ í•  ìˆ˜ ìˆìŒ.", photo: true, date: "2024-06-08 13:14" },
  { star: 4, text: "ë°¤ì— ë³„ì´ ì˜ ë³´ì—¬ì„œ íë§ ì œëŒ€ë¡œ!", photo: false, date: "2024-06-08 07:59" },
  { star: 3, text: "ì£¼ì°¨ì¥ì´ ë©€ì–´ì„œ ì•„ì‰¬ì›€.", photo: false, date: "2024-06-06 21:13" },
  { star: 5, text: "ìµœê³ ! ê°€ì¡±ì—¬í–‰ìœ¼ë¡œ ê°•ì¶”ì…ë‹ˆë‹¤.", photo: false, date: "2024-06-06 14:45" },
  { star: 2, text: "ë²Œë ˆê°€ ë§ì•„ì„œ ë°¤ì— í˜ë“¤ì—ˆì–´ìš”.", photo: false, date: "2024-06-05 23:03" },
  { star: 4, text: "ë°˜ë ¤ê²¬ ë™ë°˜ ê°€ëŠ¥í•´ì„œ ë„ˆë¬´ í¸í•´ìš”.", photo: true, date: "2024-06-05 17:52" }
];
let reviews = [...initialReviews];

function renderStars(n) {
  let stars = '';
  for (let i = 1; i <= 5; i++) {
    stars += `<span class="star${i <= n ? ' filled' : ''}">â˜…</span>`;
  }
  return stars;
}



// í›„ê¸° ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
function renderList() {
  const filterStar = document.getElementById('filter-star').value;
  const sortOrder = document.getElementById('sort-order').value;
  let arr = reviews.slice();

  // í•„í„°
  if (filterStar !== "all") {
  arr = arr.filter(r => r.star === Number(filterStar));
}

  // ì •ë ¬
  arr.sort((a, b) => {
    if(sortOrder === "latest") return b.date.localeCompare(a.date);
    if(sortOrder === "oldest") return a.date.localeCompare(b.date);
    if(sortOrder === "highstar") return b.star - a.star || b.date.localeCompare(a.date);
    if(sortOrder === "lowstar") return a.star - b.star || b.date.localeCompare(a.date);
    return 0;
  });

  // í›„ê¸° í‰ê·  ë³„ì  ê³„ì‚°
  let avg = 0;
  if (arr.length) avg = (arr.reduce((s,r)=>s+r.star,0)/arr.length).toFixed(1);

  document.getElementById('hero-rating').textContent = avg || "-";

  // ë Œë”ë§
  document.getElementById('review-list').innerHTML = arr.map(r => `
    <div class="review-item">
      <span class="review-stars">${renderStars(r.star)}</span>
      <span class="review-item-text">${r.text}
      ${r.photo?'<span class="review-photo-icon" title="ì‚¬ì§„ì²¨ë¶€">ğŸ“·</span>':''}
      </span>
    </div>
  `).join('') || `<div style="color:#aaa; text-align:center; margin-top:55px;">í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
}

// ë³„ì  ì„ íƒ ë Œë”ë§ ë° ì²˜ë¦¬
let formStar = 5;
function renderFormStars() {
  let dom = "";
  for(let i=1; i<=5; i++){
    dom += `<span class="star${i>formStar?' inactive':''}" data-val="${i}">â˜…</span>`;
  }
  document.getElementById('form-stars').innerHTML = dom;
  document.querySelectorAll('#form-stars .star').forEach(star => {
    star.onclick = () => {
      formStar = Number(star.getAttribute('data-val'));
      renderFormStars();
    }
  });
}
renderFormStars();

// í•„í„°, ì •ë ¬, ê²€ìƒ‰ ì´ë²¤íŠ¸
['filter-star','sort-order','review-search'].forEach(id=>{
  document.getElementById(id).oninput = renderList;
  document.getElementById(id).onchange = renderList;
});

document.getElementById('review-form').onsubmit = function(e){
  e.preventDefault();  // â—â— ìƒˆë¡œê³ ì¹¨ ë°©ì§€

  const txt = this.querySelector('textarea').value.trim();
  if (!txt) return;

  const hasPhoto = false;
  const d = new Date();
  const dateStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
  reviews.unshift({star: formStar, text: txt, photo: hasPhoto, date: dateStr});
  this.querySelector('textarea').value = '';
  renderList();

  setTimeout(() => {
    document.querySelector('.review-list-wrapper').scrollTop = 0;
  }, 30);
};

renderList();

// ì‚¬ì§„ì²¨ë¶€ ë²„íŠ¼ ì•ˆë‚´ë§Œ
document.getElementById('photo-upload').disabled = false;
document.getElementById('photo-upload').addEventListener('change', function(){
  alert("ì‚¬ì§„ ì €ì¥/ì—…ë¡œë“œ ê¸°ëŠ¥ì€ êµ¬í˜„ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.");
  this.value = "";
});
</script>
</body>
</html>
